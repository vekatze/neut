data cmp-op {
| Eql
| Neq
| SGt
| SGe
| SLt
| SLe
| UGt
| UGe
| ULt
| ULe
| FOEq
| FONe
| FOGt
| FOGe
| FOLt
| FOLe
| FUEq
| FUGt
| FUGe
| FULt
| FULe
| FUNe
| FOrd
| FUno
| FTrue
| FFalse
}

define icmp(x: &text): text {
  core.text.append("icmp ", x)
}

define fcmp(x: &text): text {
  core.text.append("fcmp ", x)
}

define show-cmp-op(op: &cmp-op): text {
  case op {
  | Eql =>
    icmp("eq")
  | Neq =>
    icmp("ne")
  | SGt =>
    icmp("sgt")
  | SGe =>
    icmp("sge")
  | SLt =>
    icmp("slt")
  | SLe =>
    icmp("sle")
  | UGt =>
    icmp("ugt")
  | UGe =>
    icmp("uge")
  | ULt =>
    icmp("ult")
  | ULe =>
    icmp("ule")
  | FOEq =>
    fcmp("oeq")
  | FONe =>
    fcmp("one")
  | FOGt =>
    fcmp("ogt")
  | FOGe =>
    fcmp("oge")
  | FOLt =>
    fcmp("olt")
  | FOLe =>
    fcmp("ole")
  | FUEq =>
    fcmp("ueq")
  | FUGt =>
    fcmp("ugt")
  | FUGe =>
    fcmp("uge")
  | FULt =>
    fcmp("ult")
  | FULe =>
    fcmp("ule")
  | FUNe =>
    fcmp("une")
  | FOrd =>
    fcmp("ord")
  | FUno =>
    fcmp("uno")
  | FTrue =>
    fcmp("true")
  | FFalse =>
    fcmp("false")
  }
}

define int-cmp-op-from-text(name: &text): ?cmp-op {
  if eq-text(name, "eq") {
    Right(Eql)
  } else-if eq-text(name, "ne") {
    Right(Neq)
  } else-if eq-text(name, "gt") {
    Right(SGt)
  } else-if eq-text(name, "ge") {
    Right(SGe)
  } else-if eq-text(name, "lt") {
    Right(SLt)
  } else-if eq-text(name, "le") {
    Right(SLe)
  } else-if eq-text(name, "ugt") {
    Right(UGt)
  } else-if eq-text(name, "uge") {
    Right(UGe)
  } else-if eq-text(name, "ult") {
    Right(ULt)
  } else-if eq-text(name, "ule") {
    Right(ULe)
  } else {
    none
  }
}
