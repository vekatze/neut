import {
  this.app.app {app},
  this.language.common.base-name {_Base-Name, _Base-Name-N, base-name, base-name-from-text, text-from-base-name},
  this.logger.hint {hint},
}

data local-locator {
| _Local-Locator(base-name)
}

define text-from-local-locator(ll: local-locator): text {
  let _Local-Locator(bn) = ll;
  text-from-base-name(bn)
}

define local-locator-from-text(m: hint, input: &text): app(local-locator) {
  try bn = base-name-from-text(m, input);
  Right(_Local-Locator(bn))
}

define make-local-locator(bn: base-name): local-locator {
  _Local-Locator(bn)
}

define eq-local-locator(x: &local-locator, y: &local-locator): bool {
  tie _Local-Locator(x) = x;
  tie _Local-Locator(y) = y;
  case x, y {
  | _Base-Name(x), _Base-Name(y) =>
    eq-text(x, y)
  | _Base-Name(x), _Base-Name-N(y) =>
    eq-text(x, *y)
  | _Base-Name-N(x), _Base-Name(y) =>
    eq-text(*x, y)
  | _Base-Name-N(x), _Base-Name-N(y) =>
    eq-text(*x, *y)
  | _, _ =>
    False
  }
}
